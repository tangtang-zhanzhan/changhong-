"use strict";function addList(){$("section .cart .tr").after("");var t=JSON.parse(localStorage.getItem("shop"));t&&t.forEach(function(t){var a='\n        <div class="ttr clearfix" date-id="'+t.id+'">\n        <div class="xz lf"><input class="dx" type="checkbox"></div>\n        <div class="shop clearfix">\n            <div class="sc lf">\n                <img class="reml rt" class="rt" src="../img/b2b/car-icon07.png" alt="">\n                <img class="rt" src="../img/b2b/car-icon06.png" alt="">\n            </div>\n            <div class="nr1 lf">\n                <div class="tujie">\n                    <img src="'+t.img[0]+'" alt="">\n                <p>'+t.name+'</p>\n                </div>\n                <div class="jg">\n                    单价<span>'+t.price+' </span>元\n                </div>\n                <div class="f_num">\n                    <p> 数量</p>\n                    <div class="js">\n                        <button class="jian">-</button>\n                        <input class="nmm" type="text" value="'+t.num+'">\n                        <button class="jia">+</button>\n                    </div>\n                </div>\n            </div>\n            <div class="sx1 rt">有货</div>\n        </div>\n    </div>\n        ';$("section .cart").append(a)})}addList(),$(document).ready(function(){var a=0,n=0,t=JSON.parse(localStorage.getItem("shop"));function o(){var t=JSON.parse(localStorage.getItem("shop"));n=a=0,t.forEach(function(t){1==t.ck&&(n+=t.num*t.price,a+=+t.num,$(".play .pla .s_j").add($(".cart .nr span")).html(a),$(".play .pla .s_l").html(n))})}t?(t.every(function(t){return 1==t.ck})?$(".tr .qx").prop("checked",!0):$(".tr .qx").prop("checked",!1),t.forEach(function(t,a){1==t.ck&&$(".ttr").eq(a).children().children().prop("checked",!0)}),o()):$(".tr .qx").prop("checked",!1),$(document).on("click",function(t){var a,n,e,r,c=this,i=JSON.parse(localStorage.getItem("shop")),s=$(t.target);"+"==s.text()&&(a=s.prev().val(),a++,s.prev().val(a),n=s.parent().parent().parent().parent().parent().attr("date-id"),i.forEach(function(t){t.id==n&&(t.num=a)}),localStorage.setItem("shop",JSON.stringify(i)),o()),"-"==s.text()&&((a=s.next().val())<=1?a=1:a--,s.next().val(a),n=s.parent().parent().parent().parent().parent().attr("date-id"),i.forEach(function(t){t.id==n&&(t.num=a)}),localStorage.setItem("shop",JSON.stringify(i)),o()),s.hasClass("qx")&&(s.is(":checked")?($(".ttr .dx").prop("checked",!0),i.forEach(function(t){t.ck=1})):($(".ttr .dx").prop("checked",!1),i.forEach(function(t){t.ck=0})),addList(),o()),s.hasClass("dx")&&(n=s.parent().parent().attr("date-id"),i.forEach(function(t){t.id==n&&(0==t.ck?(t.ck=1,$(c).prop("checked",!0)):(t.ck=0,$(c).prop("checked",!1)))}),localStorage.setItem("shop",JSON.stringify(i)),i.every(function(t){return 1==t.ck})?$(".tr .qx").prop("checked",!0):$(".tr .qx").prop("checked",!1),location.reload(),o()),s.hasClass("reml")&&(confirm("你确定要删除吗？")&&(n=s.parent().parent().parent().attr("date-id"),i.forEach(function(t,a){t.id==n&&i.splice(a,1)}),localStorage.setItem("shop",JSON.stringify(i)),location.reload(!0)),o()),"bnt"==s.attr("class")&&($(".dx").is(":checked")?confirm("确认购买吗？")&&(e=$(".play .pla .s_j").text(),r=$(".play .pla .s_l").text(),alert("你一共购买了"+e+"件商品，需要支付￥"+r+"元"),i.forEach(function(t,a){1==t.ck&&i.splice(a,1)}),localStorage.setItem("shop",JSON.stringify(i)),location.reload(!0)):alert("请先选择商品"),o())}),$(".cart .nmm")[0].oninput=function(){var a=parseInt($(this).val()),n=$(this).parent().parent().parent().parent().parent().attr("date-id");t.forEach(function(t){t.id==n&&(t.num=a)}),localStorage.setItem("shop",JSON.stringify(t)),o()}});